<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting Data from the Human Connectome Project (HCP) • neurohcp</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting Data from the Human Connectome Project (HCP)">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">neurohcp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.10.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/hcp.html">Getting Data from the Human Connectome Project (HCP)</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/muschellij2/neurohcp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting Data from the Human Connectome Project
(HCP)</h1>
                        <h4 data-toc-skip class="author">John
Muschelli</h4>
            
            <h4 data-toc-skip class="date">2025-02-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/muschellij2/neurohcp/blob/95.s/vignettes/hcp.Rmd" class="external-link"><code>vignettes/hcp.Rmd</code></a></small>
      <div class="hidden name"><code>hcp.Rmd</code></div>

    </div>

    
    
<p>All code for this document is located at <a href="https://raw.githubusercontent.com/muschellij2/neuroc/master/neurohcp/index.R" class="external-link">here</a>.</p>
<div class="section level2">
<h2 id="human-connectome-project-hcp">Human Connectome Project (HCP)<a class="anchor" aria-label="anchor" href="#human-connectome-project-hcp"></a>
</h2>
<p>The <a href="https://www.humanconnectome.org/" class="external-link">Human Connectome
Project</a> (HCP) is a consortium of sites whose goal is to map “human
brain circuitry in a target number of 1200 healthy adults using
cutting-edge methods of noninvasive neuroimaging” (<a href="https://www.humanconnectome.org/" class="external-link">https://www.humanconnectome.org/</a>).
It includes a large cohort of individuals with a vast amount of
neuroimaging data ranging from structural magnetic resonance imaging
(MRI), functional MRI – both during tasks and resting-state– and
diffusion tensor imaging (DTI), from multiple sites.</p>
</div>
<div class="section level2">
<h2 id="getting-access-to-the-data">Getting Access to the Data<a class="anchor" aria-label="anchor" href="#getting-access-to-the-data"></a>
</h2>
<p>The data is available to those that agree to the license. Users can
either pay to get hard drives of the data sent to them, named
“Connectome In A Box”, or access the data online. The data can be
obtained through the database at <a href="http://db.humanconnectome.org" class="external-link">http://db.humanconnectome.org</a>.
Data can be downloaded from the website directly in a browser or through
an Amazon Simple Storage Solution (S3) bucket. We will focus on
accessing the data from S3.</p>
<div class="section level3">
<h3 id="getting-an-accessapi-key">Getting an Access/API Key<a class="anchor" aria-label="anchor" href="#getting-an-accessapi-key"></a>
</h3>
<p>Once logged into <a href="http://db.humanconnectome.org" class="external-link">http://db.humanconnectome.org</a>
and the terms are accepted, the user must enable Amazon S3 access for
their Amazon account. The user will then be provided an access key
identifier (ID), which is required to authenticate a user to Amazon as
well as a secret key. These access and secret keys are necessary for the
<a href="https://github.com/muschellij2/neurohcp" class="external-link">neurohcp package</a>,
and will be referred to as access keys or API (application program
interface) keys.</p>
</div>
</div>
<div class="section level2">
<h2 id="installing-the-neurohcp-package">Installing the neurohcp package<a class="anchor" aria-label="anchor" href="#installing-the-neurohcp-package"></a>
</h2>
<p>We will install the neurohcp package using the Neuroconductor
installer:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">"http://neuroconductor.org/neurocLite.R"</span><span class="op">)</span></span>
<span><span class="fu">neuro_install</span><span class="op">(</span><span class="st">"neurohcp"</span>, release <span class="op">=</span> <span class="st">"stable"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="setting-the-api-key">Setting the API key<a class="anchor" aria-label="anchor" href="#setting-the-api-key"></a>
</h3>
<p>In the <code>neurohcp</code> package, <code>set_aws_api_key</code>
will set the AWS access keys:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_aws_api_key.html">set_aws_api_key</a></span><span class="op">(</span>access_key <span class="op">=</span> <span class="st">"ACCESS_KEY"</span>, secret_key <span class="op">=</span> <span class="st">"SECRET_KEY"</span><span class="op">)</span></span></code></pre></div>
<p>or these can be stored in <code>AWS_ACCESS_KEY_ID</code>,
<code>AWS_SECRET_ACCESS_KEY</code> environment variables,
respectively.</p>
<p>Once these are set, the functions of neurohcp are ready to use. To
test that the API keys are set correctly, one can run
<code>bucketlist</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="../reference/set_aws_api_key.html">have_aws_key</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">neurohcp</span><span class="fu">::</span><span class="fu"><a href="../reference/bucketlist.html">bucketlist</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>We see that <code>hcp-openaccess</code> is a bucket that we have
access to, and therefore have access to the data.</p>
</div>
<div class="section level3">
<h3 id="getting-data-downloading-a-directory-of-data">Getting Data: Downloading a Directory of Data<a class="anchor" aria-label="anchor" href="#getting-data-downloading-a-directory-of-data"></a>
</h3>
<p>In the neurohcp package, there is a data set indicating the scans
read for each subject, named <code>hcp_900_scanning_info</code>. We can
subset those subjects that have diffusion tensor imaging:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ids_with_dwi</span> <span class="op">=</span> <span class="va">hcp_900_scanning_info</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">scan_type</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"dMRI"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="va">unique</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ids_with_dwi</span><span class="op">)</span></span></code></pre></div>
<pre><code> [38;5;246m# A tibble: 6 × 1 [39m
  id    
   [3m [38;5;246m&lt;chr&gt; [39m [23m 
 [38;5;250m1 [39m 100307
 [38;5;250m2 [39m 100408
 [38;5;250m3 [39m 101006
 [38;5;250m4 [39m 101107
 [38;5;250m5 [39m 101309
 [38;5;250m6 [39m 101410</code></pre>
<p>Let us download the complete directory of diffusion data using
<code>download_hcp_dir</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">=</span> <span class="fu"><a href="../reference/download_hcp_dir.html">download_hcp_dir</a></span><span class="op">(</span><span class="st">"HCP/100307/T1w/Diffusion"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">output_files</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] "bvals"                   "bvecs"                  
[3] "data.nii.gz"             "grad_dev.nii.gz"        
[5] "nodif_brain_mask.nii.gz"</code></pre>
<p>This diffusion data is the data that can be used to create summaries
such as fractional anisotropy and mean diffusivity.</p>
<p>If we create a new column with all the directories, we can iterate
over these to download all the diffusion data for these subjects from
the HCP database.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ids_with_dwi</span> <span class="op">=</span> <span class="va">ids_with_dwi</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>id_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"HCP/"</span>, <span class="va">id</span>, <span class="st">"/T1w/Diffusion"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="getting-data-downloading-a-single-file">Getting Data: Downloading a Single File<a class="anchor" aria-label="anchor" href="#getting-data-downloading-a-single-file"></a>
</h3>
<p>We can also download a single file using
<code>download_hcp_file</code>. Here we will simply download the
<code>bvals</code> file:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="../reference/set_aws_api_key.html">have_aws_key</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ret</span> <span class="op">=</span> <span class="fu"><a href="../reference/download_hcp_file.html">download_hcp_file</a></span><span class="op">(</span><span class="st">"HCP/100307/T1w/Diffusion/bvals"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by John Muschelli.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
